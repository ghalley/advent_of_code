def light_up(directions)
  lights = Hash.new(false)

  directions.each do |direction|
    h_length = direction[:end][0] - direction[:start][0] + 1
    v_length = direction[:end][1] - direction[:start][1] + 1

    h_length.times do |h|
      v_length.times do |v|
        current_light = lights[[(h+ direction[:start][0]), (v + direction[:start][1])]]

        lights[[(h+ direction[:start][0]), (v + direction[:start][1])]] = set_light(direction[:action], current_light)
      end
    end
  end

  lights.values.count {|v| v}
end

def set_light(action, current_value)
  case action
  when 'on'
    true
  when 'off'
    false
  when 'toggle'
    current_value ? false : true
  end
end

def brighten_up(directions)
  lights = Hash.new(0)

  directions.each do |direction|
    h_length = direction[:end][0] - direction[:start][0] + 1
    v_length = direction[:end][1] - direction[:start][1] + 1

    h_length.times do |h|
      v_length.times do |v|
        current_light = lights[[(h+ direction[:start][0]), (v + direction[:start][1])]]

        lights[[(h+ direction[:start][0]), (v + direction[:start][1])]] = set_brightness(direction[:action], current_light)
      end
    end
  end

  lights.values.reduce(:+)
end

def set_brightness(action, current_value)
  case action
  when 'on'
    current_value + 1
  when 'off'
    current_value - 1
  when 'toggle'
    current_value + 2
  end
end

# directions = [{action: 'toggle', start: [0,0], end: [999,999]}]
# directions = [{action: 'toggle', start: [0,0], end: [999,0]}]
# directions = [{action: 'on', start: [4,4], end: [5,5]}]
directions = [{action: 'on', start: [489,959], end: [759,964]},
{action: 'off', start: [820,516], end: [871,914]},
{action: 'off', start: [427,423], end: [929,502]},
{action: 'on', start: [774,14], end: [977,877]},
{action: 'on', start: [410,146], end: [864,337]},
{action: 'on', start: [931,331], end: [939,812]},
{action: 'off', start: [756,53], end: [923,339]},
{action: 'off', start: [313,787], end: [545,979]},
{action: 'off', start: [12,823], end: [102,934]},
{action: 'toggle', start: [756,965], end: [812,992]},
{action: 'off', start: [743,684], end: [789,958]},
{action: 'toggle', start: [120,314], end: [745,489]},
{action: 'toggle', start: [692,845], end: [866,994]},
{action: 'off', start: [587,176], end: [850,273]},
{action: 'off', start: [674,321], end: [793,388]},
{action: 'toggle', start: [749,672], end: [973,965]},
{action: 'on', start: [943,30], end: [990,907]},
{action: 'on', start: [296,50], end: [729,664]},
{action: 'on', start: [212,957], end: [490,987]},
{action: 'toggle', start: [171,31], end: [688,88]},
{action: 'off', start: [991,989], end: [994,998]},
{action: 'off', start: [913,943], end: [958,953]},
{action: 'off', start: [278,258], end: [367,386]},
{action: 'toggle', start: [275,796], end: [493,971]},
{action: 'off', start: [70,873], end: [798,923]},
{action: 'toggle', start: [258,985], end: [663,998]},
{action: 'on', start: [601,259], end: [831,486]},
{action: 'off', start: [914,94], end: [941,102]},
{action: 'off', start: [558,161], end: [994,647]},
{action: 'on', start: [119,662], end: [760,838]},
{action: 'toggle', start: [378,775], end: [526,852]},
{action: 'off', start: [384,670], end: [674,972]},
{action: 'off', start: [249,41], end: [270,936]},
{action: 'on', start: [614,742], end: [769,780]},
{action: 'on', start: [427,70], end: [575,441]},
{action: 'on', start: [410,478], end: [985,753]},
{action: 'off', start: [619,46], end: [931,342]},
{action: 'on', start: [284,55], end: [768,922]},
{action: 'off', start: [40,592], end: [728,685]},
{action: 'on', start: [825,291], end: [956,950]},
{action: 'on', start: [147,843], end: [592,909]},
{action: 'off', start: [218,675], end: [972,911]},
{action: 'toggle', start: [249,291], end: [350,960]},
{action: 'off', start: [556,80], end: [967,675]},
{action: 'toggle', start: [609,148], end: [968,279]},
{action: 'toggle', start: [217,605], end: [961,862]},
{action: 'toggle', start: [407,177], end: [548,910]},
{action: 'toggle', start: [400,936], end: [599,938]},
{action: 'off', start: [721,101], end: [925,455]},
{action: 'on', start: [268,631], end: [735,814]},
{action: 'toggle', start: [549,969], end: [612,991]},
{action: 'toggle', start: [553,268], end: [689,432]},
{action: 'off', start: [817,668], end: [889,897]},
{action: 'toggle', start: [801,544], end: [858,556]},
{action: 'toggle', start: [615,729], end: [832,951]},
{action: 'off', start: [427,477], end: [958,948]},
{action: 'on', start: [164,49], end: [852,946]},
{action: 'on', start: [542,449], end: [774,776]},
{action: 'off', start: [923,196], end: [980,446]},
{action: 'toggle', start: [90,310], end: [718,846]},
{action: 'off', start: [657,215], end: [744,252]},
{action: 'off', start: [800,239], end: [811,712]},
{action: 'on', start: [502,90], end: [619,760]},
{action: 'toggle', start: [649,512], end: [862,844]},
{action: 'off', start: [334,903], end: [823,935]},
{action: 'off', start: [630,233], end: [839,445]},
{action: 'on', start: [713,67], end: [839,865]},
{action: 'on', start: [932,50], end: [982,411]},
{action: 'off', start: [480,729], end: [984,910]},
{action: 'on', start: [100,219], end: [796,395]},
{action: 'on', start: [758,108], end: [850,950]},
{action: 'off', start: [427,276], end: [439,938]},
{action: 'on', start: [178,284], end: [670,536]},
{action: 'toggle', start: [540,27], end: [625,102]},
{action: 'off', start: [906,722], end: [936,948]},
{action: 'toggle', start: [345,418], end: [859,627]},
{action: 'toggle', start: [175,775], end: [580,781]},
{action: 'toggle', start: [863,28], end: [929,735]},
{action: 'off', start: [824,858], end: [905,973]},
{action: 'toggle', start: [752,312], end: [863,425]},
{action: 'on', start: [985,716], end: [988,852]},
{action: 'off', start: [68,504], end: [763,745]},
{action: 'toggle', start: [76,209], end: [810,720]},
{action: 'off', start: [657,607], end: [676,664]},
{action: 'toggle', start: [596,869], end: [896,921]},
{action: 'off', start: [915,411], end: [968,945]},
{action: 'off', start: [368,39], end: [902,986]},
{action: 'on', start: [11,549], end: [393,597]},
{action: 'off', start: [842,893], end: [976,911]},
{action: 'toggle', start: [274,106], end: [581,329]},
{action: 'toggle', start: [406,403], end: [780,950]},
{action: 'toggle', start: [408,988], end: [500,994]},
{action: 'toggle', start: [217,73], end: [826,951]},
{action: 'on', start: [917,872], end: [961,911]},
{action: 'toggle', start: [394,34], end: [510,572]},
{action: 'toggle', start: [424,603], end: [583,626]},
{action: 'toggle', start: [106,159], end: [755,738]},
{action: 'off', start: [244,610], end: [472,709]},
{action: 'on', start: [350,265], end: [884,690]},
{action: 'on', start: [688,184], end: [928,280]},
{action: 'toggle', start: [279,443], end: [720,797]},
{action: 'off', start: [615,493], end: [888,610]},
{action: 'toggle', start: [118,413], end: [736,632]},
{action: 'on', start: [798,782], end: [829,813]},
{action: 'off', start: [250,934], end: [442,972]},
{action: 'on', start: [68,503], end: [400,949]},
{action: 'toggle', start: [297,482], end: [313,871]},
{action: 'toggle', start: [710,3], end: [839,859]},
{action: 'on', start: [125,300], end: [546,888]},
{action: 'toggle', start: [482,39], end: [584,159]},
{action: 'off', start: [536,89], end: [765,962]},
{action: 'on', start: [530,518], end: [843,676]},
{action: 'on', start: [994,467], end: [994,676]},
{action: 'on', start: [623,628], end: [744,927]},
{action: 'toggle', start: [704,912], end: [837,983]},
{action: 'on', start: [154,364], end: [517,412]},
{action: 'toggle', start: [344,409], end: [780,524]},
{action: 'off', start: [578,740], end: [725,879]},
{action: 'on', start: [251,933], end: [632,957]},
{action: 'on', start: [827,705], end: [971,789]},
{action: 'toggle', start: [191,282], end: [470,929]},
{action: 'toggle', start: [324,525], end: [446,867]},
{action: 'toggle', start: [534,343], end: [874,971]},
{action: 'toggle', start: [550,650], end: [633,980]},
{action: 'toggle', start: [837,404], end: [881,915]},
{action: 'toggle', start: [338,881], end: [845,905]},
{action: 'on', start: [469,462], end: [750,696]},
{action: 'on', start: [741,703], end: [892,870]},
{action: 'off', start: [570,215], end: [733,562]},
{action: 'on', start: [445,576], end: [870,775]},
{action: 'on', start: [466,747], end: [554,878]},
{action: 'off', start: [820,453], end: [868,712]},
{action: 'off', start: [892,706], end: [938,792]},
{action: 'off', start: [300,238], end: [894,746]},
{action: 'off', start: [306,44], end: [457,444]},
{action: 'off', start: [912,569], end: [967,963]},
{action: 'toggle', start: [109,756], end: [297,867]},
{action: 'on', start: [37,546], end: [41,951]},
{action: 'on', start: [321,637], end: [790,910]},
{action: 'toggle', start: [66,50], end: [579,301]},
{action: 'toggle', start: [933,221], end: [933,791]},
{action: 'on', start: [486,676], end: [878,797]},
{action: 'on', start: [417,231], end: [556,317]},
{action: 'toggle', start: [904,468], end: [981,873]},
{action: 'on', start: [417,675], end: [749,712]},
{action: 'on', start: [692,371], end: [821,842]},
{action: 'toggle', start: [324,73], end: [830,543]},
{action: 'on', start: [912,490], end: [977,757]},
{action: 'off', start: [634,872], end: [902,949]},
{action: 'toggle', start: [266,779], end: [870,798]},
{action: 'on', start: [772,982], end: [990,996]},
{action: 'off', start: [607,46], end: [798,559]},
{action: 'on', start: [295,602], end: [963,987]},
{action: 'on', start: [657,86], end: [944,742]},
{action: 'off', start: [334,639], end: [456,821]},
{action: 'off', start: [997,667], end: [997,670]},
{action: 'off', start: [725,832], end: [951,945]},
{action: 'off', start: [30,120], end: [952,984]},
{action: 'on', start: [860,965], end: [917,976]},
{action: 'toggle', start: [471,997], end: [840,998]},
{action: 'off', start: [319,307], end: [928,504]},
{action: 'toggle', start: [823,631], end: [940,908]},
{action: 'toggle', start: [969,984], end: [981,993]},
{action: 'off', start: [691,319], end: [865,954]},
{action: 'toggle', start: [911,926], end: [938,929]},
{action: 'on', start: [953,937], end: [968,991]},
{action: 'toggle', start: [914,643], end: [975,840]},
{action: 'on', start: [266,982], end: [436,996]},
{action: 'off', start: [101,896], end: [321,932]},
{action: 'off', start: [193,852], end: [751,885]},
{action: 'off', start: [576,532], end: [863,684]},
{action: 'on', start: [761,456], end: [940,783]},
{action: 'on', start: [20,290], end: [398,933]},
{action: 'off', start: [435,335], end: [644,652]},
{action: 'on', start: [830,569], end: [905,770]},
{action: 'off', start: [630,517], end: [905,654]},
{action: 'on', start: [664,53], end: [886,976]},
{action: 'toggle', start: [275,416], end: [408,719]},
{action: 'on', start: [370,621], end: [515,793]},
{action: 'on', start: [483,373], end: [654,749]},
{action: 'on', start: [656,786], end: [847,928]},
{action: 'off', start: [532,752], end: [945,974]},
{action: 'toggle', start: [301,150], end: [880,792]},
{action: 'off', start: [951,488], end: [958,952]},
{action: 'on', start: [207,729], end: [882,828]},
{action: 'toggle', start: [694,532], end: [973,961]},
{action: 'toggle', start: [676,639], end: [891,802]},
{action: 'off', start: [653,6], end: [905,519]},
{action: 'toggle', start: [391,109], end: [418,312]},
{action: 'on', start: [877,423], end: [957,932]},
{action: 'on', start: [340,145], end: [563,522]},
{action: 'off', start: [978,467], end: [988,895]},
{action: 'off', start: [396,418], end: [420,885]},
{action: 'off', start: [31,308], end: [816,316]},
{action: 'on', start: [107,675], end: [758,824]},
{action: 'on', start: [61,82], end: [789,876]},
{action: 'on', start: [750,743], end: [754,760]},
{action: 'toggle', start: [88,733], end: [736,968]},
{action: 'off', start: [754,349], end: [849,897]},
{action: 'toggle', start: [157,50], end: [975,781]},
{action: 'off', start: [230,231], end: [865,842]},
{action: 'off', start: [516,317], end: [630,329]},
{action: 'off', start: [697,820], end: [829,903]},
{action: 'on', start: [218,250], end: [271,732]},
{action: 'toggle', start: [56,167], end: [404,431]},
{action: 'toggle', start: [626,891], end: [680,927]},
{action: 'toggle', start: [370,207], end: [791,514]},
{action: 'toggle', start: [860,74], end: [949,888]},
{action: 'on', start: [416,527], end: [616,541]},
{action: 'off', start: [745,449], end: [786,908]},
{action: 'on', start: [485,554], end: [689,689]},
{action: 'on', start: [586,62], end: [693,141]},
{action: 'toggle', start: [506,759], end: [768,829]},
{action: 'on', start: [473,109], end: [929,166]},
{action: 'on', start: [760,617], end: [773,789]},
{action: 'toggle', start: [595,683], end: [618,789]},
{action: 'off', start: [210,775], end: [825,972]},
{action: 'toggle', start: [12,426], end: [179,982]},
{action: 'on', start: [774,539], end: [778,786]},
{action: 'on', start: [102,498], end: [121,807]},
{action: 'off', start: [706,897], end: [834,965]},
{action: 'off', start: [678,529], end: [824,627]},
{action: 'on', start: [7,765], end: [615,870]},
{action: 'off', start: [730,872], end: [974,943]},
{action: 'off', start: [595,626], end: [836,711]},
{action: 'off', start: [215,424], end: [841,959]},
{action: 'toggle', start: [341,780], end: [861,813]},
{action: 'toggle', start: [507,503], end: [568,822]},
{action: 'on', start: [252,603], end: [349,655]},
{action: 'toggle', start: [93,521], end: [154,834]},
{action: 'on', start: [565,682], end: [951,954]},
{action: 'on', start: [544,318], end: [703,418]},
{action: 'toggle', start: [756,953], end: [891,964]},
{action: 'on', start: [531,123], end: [856,991]},
{action: 'on', start: [148,315], end: [776,559]},
{action: 'off', start: [925,835], end: [963,971]},
{action: 'on', start: [895,944], end: [967,964]},
{action: 'off', start: [102,527], end: [650,747]},
{action: 'toggle', start: [626,105], end: [738,720]},
{action: 'off', start: [160,75], end: [384,922]},
{action: 'toggle', start: [813,724], end: [903,941]},
{action: 'on', start: [207,107], end: [982,849]},
{action: 'toggle', start: [750,505], end: [961,697]},
{action: 'toggle', start: [105,410], end: [885,819]},
{action: 'on', start: [226,104], end: [298,283]},
{action: 'off', start: [224,604], end: [508,762]},
{action: 'on', start: [477,368], end: [523,506]},
{action: 'off', start: [477,901], end: [627,936]},
{action: 'off', start: [887,131], end: [889,670]},
{action: 'on', start: [896,994], end: [938,999]},
{action: 'toggle', start: [401,580], end: [493,728]},
{action: 'toggle', start: [987,184], end: [991,205]},
{action: 'on', start: [821,643], end: [882,674]},
{action: 'toggle', start: [784,940], end: [968,959]},
{action: 'off', start: [251,293], end: [274,632]},
{action: 'off', start: [339,840], end: [341,844]},
{action: 'off', start: [675,351], end: [675,836]},
{action: 'toggle', start: [918,857], end: [944,886]},
{action: 'toggle', start: [70,253], end: [918,736]},
{action: 'off', start: [612,604], end: [772,680]},
{action: 'off', start: [277,40], end: [828,348]},
{action: 'toggle', start: [692,139], end: [698,880]},
{action: 'toggle', start: [124,446], end: [883,453]},
{action: 'toggle', start: [969,932], end: [990,945]},
{action: 'toggle', start: [855,692], end: [993,693]},
{action: 'toggle', start: [722,472], end: [887,899]},
{action: 'toggle', start: [978,149], end: [985,442]},
{action: 'toggle', start: [837,540], end: [916,889]},
{action: 'off', start: [612,2], end: [835,82]},
{action: 'toggle', start: [560,767], end: [878,856]},
{action: 'on', start: [461,734], end: [524,991]},
{action: 'toggle', start: [206,824], end: [976,912]},
{action: 'on', start: [826,610], end: [879,892]},
{action: 'on', start: [577,699], end: [956,933]},
{action: 'off', start: [9,250], end: [50,529]},
{action: 'off', start: [77,657], end: [817,677]},
{action: 'on', start: [68,419], end: [86,426]},
{action: 'on', start: [991,720], end: [992,784]},
{action: 'on', start: [668,20], end: [935,470]},
{action: 'off', start: [133,418], end: [613,458]},
{action: 'off', start: [487,286], end: [540,328]},
{action: 'toggle', start: [247,874], end: [840,955]},
{action: 'toggle', start: [301,808], end: [754,970]},
{action: 'off', start: [34,194], end: [578,203]},
{action: 'off', start: [451,49], end: [492,921]},
{action: 'on', start: [907,256], end: [912,737]},
{action: 'off', start: [479,305], end: [702,587]},
{action: 'on', start: [545,583], end: [732,749]},
{action: 'toggle', start: [11,16], end: [725,868]},
{action: 'on', start: [965,343], end: [986,908]},
{action: 'on', start: [674,953], end: [820,965]},
{action: 'toggle', start: [398,147], end: [504,583]},
{action: 'off', start: [778,194], end: [898,298]},
{action: 'on', start: [179,140], end: [350,852]},
{action: 'off', start: [241,118], end: [530,832]},
{action: 'off', start: [41,447], end: [932,737]},
{action: 'off', start: [820,663], end: [832,982]},
{action: 'on', start: [550,460], end: [964,782]},
{action: 'on', start: [31,760], end: [655,892]},
{action: 'toggle', start: [628,958], end: [811,992]}
]

# puts light_up(directions)
puts brighten_up(directions)
